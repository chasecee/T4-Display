# Minimal T4-Display Configuration - ACTUALLY WORKING VERSION! ðŸ’…
# Target chip
CONFIG_IDF_TARGET="esp32"

# Flash configuration
CONFIG_ESPTOOLPY_FLASHSIZE_4MB=y
CONFIG_ESPTOOLPY_FLASHSIZE="4MB"

# Partition table
CONFIG_PARTITION_TABLE_CUSTOM=y
CONFIG_PARTITION_TABLE_CUSTOM_FILENAME="partitions.csv"

# CPU frequency - we want speed for display
CONFIG_ESP_DEFAULT_CPU_FREQ_MHZ_240=y

# PSRAM (actually needed)
CONFIG_SPIRAM=y
CONFIG_SPIRAM_BOOT_INIT=y
CONFIG_SPIRAM_USE_MALLOC=y
CONFIG_SPIRAM_TYPE_AUTO=y
CONFIG_SPIRAM_SPEED_40M=y
CONFIG_SPIRAM_MALLOC_ALWAYSINTERNAL=16384
CONFIG_SPIRAM_MALLOC_RESERVE_INTERNAL=32768

# Performance optimizations for SPI display
CONFIG_COMPILER_OPTIMIZATION_PERF=y
CONFIG_SPI_MASTER_IN_IRAM=y
CONFIG_SPI_MASTER_ISR_IN_IRAM=y

# JPEG decoder optimizations (actually used)
CONFIG_JD_USE_ROM=n
CONFIG_JD_FORMAT=1
CONFIG_JD_SZBUF=512
CONFIG_JD_TBLCLIP=y
CONFIG_JD_FASTDECODE_TABLE=y
CONFIG_JD_FASTDECODE=2

# SPIFFS (file system - actually used)
CONFIG_SPIFFS_MAX_PARTITIONS=3
CONFIG_SPIFFS_CACHE=y
CONFIG_SPIFFS_CACHE_WR=y
CONFIG_SPIFFS_PAGE_SIZE=256

# FreeRTOS optimizations
CONFIG_FREERTOS_HZ=1000
CONFIG_ESP_MAIN_TASK_STACK_SIZE=8192

# Disable power management to avoid PSRAM issues
CONFIG_PM_ENABLE=n

# Disable watchdogs for smooth playback
CONFIG_ESP_TASK_WDT_EN=n
CONFIG_ESP_TASK_WDT_INIT=n

# === CONSERVATIVE BLOAT REMOVAL ===

# NO WiFi (saves MASSIVE space but keep LWIP for HTTP components)
CONFIG_ESP_WIFI_ENABLED=n

# NO Bluetooth
CONFIG_BT_ENABLED=n

# NO Ethernet
CONFIG_ETH_ENABLED=n

# Keep LWIP but disable features we don't need
CONFIG_LWIP_IGMP=n
CONFIG_LWIP_ICMP=n
CONFIG_LWIP_DHCP=n
CONFIG_LWIP_AUTOIP=n
CONFIG_LWIP_SNTP=n
CONFIG_LWIP_DNS=n

# NO MQTT
CONFIG_MQTT_PROTOCOL_311=n

# Disable crypto features we don't need
CONFIG_MBEDTLS_HAVE_TIME=n
CONFIG_MBEDTLS_HAVE_TIME_DATE=n
CONFIG_MBEDTLS_TLS_SERVER=n
CONFIG_MBEDTLS_TLS_CLIENT=n

# NO touch sensors
CONFIG_TOUCH_SENSOR_V1=n
CONFIG_TOUCH_SENSOR_V2=n

# NO I2S audio
CONFIG_SOC_I2S_SUPPORTED=n

# NO USB
CONFIG_USB_OTG_SUPPORTED=n

# Minimal logging for production
CONFIG_LOG_DEFAULT_LEVEL_INFO=y
CONFIG_LOG_DEFAULT_LEVEL=3
CONFIG_LOG_COLORS=n

# Heap optimization
CONFIG_HEAP_POISONING_DISABLED=y
CONFIG_HEAP_TRACING_OFF=y
CONFIG_HEAP_ABORT_WHEN_ALLOCATION_FAILS=n

# VFS minimal
CONFIG_VFS_MAX_COUNT=4

# Newlib minimal
CONFIG_NEWLIB_STDOUT_LINE_ENDING_CRLF=y
CONFIG_NEWLIB_STDIN_LINE_ENDING_CR=y
CONFIG_NEWLIB_NANO_FORMAT=y

# NO coexistence (WiFi/BT)
CONFIG_ESP_COEX_ENABLED=n

# Minimal bootloader
CONFIG_BOOTLOADER_COMPILER_OPTIMIZATION_SIZE=y
CONFIG_BOOTLOADER_LOG_LEVEL=1

# Disable unnecessary drivers we're not using
CONFIG_SOC_UART_NUM=1
CONFIG_SOC_I2C_NUM=1
CONFIG_SOC_SPI_PERIPH_NUM=2

# Disable advanced features
CONFIG_ESP_SYSTEM_EVENT_TASK_STACK_SIZE=2048
CONFIG_ESP_EVENT_POST_FROM_ISR=n
CONFIG_ESP_EVENT_POST_FROM_IRAM_ISR=n 